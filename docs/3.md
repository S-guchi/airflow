# ステップ3: はじめての DAG（TaskFlow API 版）

## 1. ファイルを置く
`dags/hello_taskflow.py` を作成して、次のコードを貼り付ける。

```python
from datetime import datetime
from airflow import DAG
from airflow.decorators import task

with DAG(
    dag_id="hello_taskflow",
    start_date=datetime(2024, 1, 1),
    schedule="@daily",
    catchup=False,
    tags=["intro"],
) as dag:

    @task
    def extract():
        # ここで外部からデータを取ってくる処理を書く（今回はダミー）
        return "airflow"

    @task
    def transform(text: str):
        # シンプルな変換（大文字化）
        return text.upper()

    @task
    def load(result: str):
        # 本来はDBやS3に書き込む場所（ここではログに出力）
        print(f"結果: {result}")

    load(transform(extract()))
```

## 2. 実行してみる
1. コンテナが起動中なら、数十秒で DAG が UI に現れる（左メニュー「DAGs」）。  
2. `hello_taskflow` をオンにして右端の再生ボタンで即時実行。  
3. グラフビューで依存関係、ログタブで `print` 出力を確認する。

## 3. なぜ TaskFlow API か
- `@task` デコレータで Python 関数をそのままタスク化し、依存は関数呼び出しの並びで表現できる。citeturn0search3
- XCom でデータ受け渡しが自動化され、引数・戻り値で書けるので学習曲線が緩やか。citeturn0search3

次は演習として、`transform` を ETL らしい処理に書き換えたり、`schedule` を `@hourly` に変えて挙動を試してみてください。
